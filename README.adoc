= jcli
:nofooter:

Sugared wrappers to execute methods from JDK and JVM-based libraries from the command line.

E.g., To generate a UUID, `java.util.UUID` contains a method `randomUUID()`. This tool helps you execute that method by invoking `jcli uuid randomUUID`.

== Motivation
The goal is to expose the wealth of utility methods available in the JVM ecosystem right at the command line.

It is also intended that this be a GraalVM-compatible project so that distributions do not require the end user to do a JVM setup with some compatible Java version.

Most methods return a single result, and so can be used in pipe operations combined with other command line utilities if needed.

== Configuration & Extensibility

`jcli` is now completely configuration-driven! You can add new commands without writing any Java code.

Command definitions are located in `src/main/resources/commands.yaml`.

```yaml
commands:
  - name: string
    className: java.lang.String
    strategy: INSTANCE
    description: "Methods from java.lang.String"
    examples:
       - "jcli string length 'hello'"

  - name: math
    className: java.lang.Math
    strategy: STATIC
    description: "Methods from java.lang.Math"
    examples:
       - "jcli math max 10 20"
```

To add a new command, simply append a new entry to this YAML file.

=== Strategies
- `STATIC`: For static utility classes (e.g., `java.lang.Math`).
- `INSTANCE`: For classes where you operate on an instance provided as the first argument (e.g., `java.lang.String`).
- `HYBRID`: Tries to match a static factory method first; if not found, treats the first argument as an instance (e.g., `java.time.Instant`).

== Available Commands

The CLI structure maps directly to the configuration in `commands.yaml`. By default:
- `jcli string` -> `java.lang.String`
- `jcli uuid` -> `java.util.UUID`
- `jcli instant` -> `java.time.Instant`
- `jcli math` -> `java.lang.Math`

In order to view the available methods for a command, you can use the `--methods` flag.

E.g., `jcli instant --methods`

=== Examples

[cols="1,1,1,1"]
|===
|SubCommand | Method | Description | Usage

|uuid
|`randomUUID`
|Generates a random UUID
|`jcli uuid randomUUID`

|instant
|`now`
|Prints the current time (ISO-8601)
|`jcli instant now`

|string
|`substring`
|Extracts substring from text
|jcli string substring 'hello world' 0 5

|math
|`max`
|Returns the greater of two values
|`jcli math max 10 20`
|===

== Build

To build this project's source code:

. Clone this project
. At the root of the project, execute `./gradlew clean build`
. The build generates a jar at `build/libs`. To execute the cli app, run `java -jar build/libs/jcli-0.1-all.jar -h` to view the help manual.

== Build Native Image

 . Install and Use GraalVM for JDK 21
 . Compile Native Image
 .. NativeCompile may take a few minutes
 
 ```
 sdk install java 21.0.1-graal
 sdk use java 21.0.1-graal
 ./gradlew nativeCompile
 ```
 
 The default output directory is `build/native/nativeCompile`.
 
 Here is how you can execute the native file.
 ```
 $ ./build/native/nativeCompile/jcli --help
 ```
 
 **Note on Native Image**: The build automatically generates the `reflect-config.json` based on your `commands.yaml`. You do **not** need to manually edit any JSON files. Simply add your command to the YAML and rebuild (`./gradlew build` or `./gradlew nativeCompile`).